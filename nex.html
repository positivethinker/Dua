<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DUA AND DARUD PLAYER</title>
  <style>
    body {
      font-family: Chivo, sans-serif;
      text-align: center;
      padding: 20px;
      font-size: 26px;
      background: #f7fafc;
    }
    .main-row {
      display: flex;
      justify-content: center;
      align-items: stretch;
      gap: 40px;
      flex-wrap: wrap;
      margin: 0 auto 10px auto;
      width: 100%;
      max-width: 1200px;
    }
    .controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 390px;
      max-width: 390px;
      height: 600px;
      max-height: 90vh;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      overflow: hidden;
      padding: 0 0 10px 0;
    }
    .controls-scroll {
      overflow-y: auto;
      width: 100%;
      padding: 0 20px;
      flex: 1 1 auto;
    }
    .section-header {
      font-size: 22px;
      font-weight: bold;
      color: #007bff;
      margin: 18px 0 6px 0;
      text-align: center;
      width: 100%;
      border-bottom: 1px solid #eee;
      padding-bottom: 2px;
    }
    .section-btn {
      font-size: 20px;
      padding: 12px 24px;
      margin: 12px 0;
      border-radius: 8px;
      border: none;
      background: Black;
      color: #fff;
      cursor: pointer;
      width: 50%;
      transition: background 0.2s;
    }
    .section-btn:hover {
      background: #0056b3;
    }
    .video-list {
      list-style: none;
      padding: 0;
      margin: 0 0 10px 0;
      width: 90%;
      text-align: left;
    }
    .video-list li {
      font-size: 18px;
      margin: 4px 0;
      padding: 4px 0;
      border-bottom: 1px dotted #ddd;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .video-serial {
      font-weight: bold;
      color: #888;
      margin-right: 8px;
      min-width: 28px;
      text-align: right;
      display: inline-block;
    }
    .video-label {
      flex: 1;
    }
    .video-loop {
      color: #007bff;
      font-size: 16px;
      margin-left: 10px;
      font-weight: bold;
    }
    .player-col {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-width: 390px;
      max-width: 640px;
      height: 600px;
      max-height: 90vh;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      padding: 0 0 10px 0;
    }
    #player {
      margin: 0 auto;
      width: 100%;
      height: 100%;
      min-width: 320px;
      min-height: 360px;
      aspect-ratio: 16 / 9;
      background: #000;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      display: flex;
      justify-content: center;
      align-items: center;
      flex: 1 1 auto;
    }
    #tooltipText {
      font-size: 16px;
      color: #555;
      font-style: italic;
      max-width: 640px;
      margin: 15px auto 10px auto;
      min-height: 20px;
      text-align: center;
    }
    p {
      font-size: 18px;
      margin-bottom: 10px;
      color: #333;
      letter-spacing: 1px;
    }
    #currentLoop, #remainingLoop {
      font-weight: bold;
      color: #007bff;
    }
    .section-select {
      font-size: 20px;
      padding: 8px 12px;
      margin: 18px 0 10px 0;
      border-radius: 8px;
      border: 1px solid #bbb;
      width: 90%;
      max-width: 340px;
      background: #f7fafc;
      color: #333;
    }
    @media (max-width: 1100px) {
      .main-row {
        flex-direction: column;
        align-items: center;
      }
      .controls, .player-col, #player {
        max-width: 100%;
        min-width: 0;
        height: auto;
      }
      .controls, .player-col {
        height: auto;
        min-width: 0;
      }
    }
    @media (max-width: 600px) {
      .main-row {
        flex-direction: column;
        gap: 24px;
      }
      .controls, .player-col, #player {
        max-width: 100%;
      }
      #tooltipText {
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <h1>DUA AND DARUD PLAYER</h1>
  <div class="main-row">
    <div class="controls">
      <select class="section-select" id="sectionDropdown" onchange="showSelectedSection()">
        <!-- Options will be generated by JS -->
      </select>
      <div class="controls-scroll" id="sectionControls"></div>
    </div>
    <div class="player-col">
      <div id="player"></div>
      <div id="tooltipText"></div>
      <p>
        PLAYED: <span id="currentLoop">0</span> |
        REMAIN: <span id="remainingLoop">0</span>
      </p>
    </div>
  </div>
  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    // All your sections and videos here, with loop values set as requested
    const videoSections = [
      {
        name: "প্রতিদিন",
        videos: [
          { id: "14uh3215Vls", start: 0, end: 30, label: "দরুদ শরীফ", tooltip: "দরুদ শরীফ", loop: 7 },
          { id: "3NjYi7mCtDs", start: 34.5, end: 39, label: "সুবহানাল্লাহি ওয়া বিহামদিহী", tooltip: "প্রতিদিন ১০০ বার | আস্তাগফিরুল্লাহ ১০০ বার", loop: 100 },
          { id: "3NjYi7mCtDs", start: 39, end: 40, label: "আস্তাগফিরুল্লাহ", tooltip: "আস্তাগফিরুল্লাহ ১০০ বার", loop: 100 },
          { id: "paplOoJGGxg", start: 1, end: 10, label: "সুবহানাল্লাহ | ওয়ালহামদুলিল্লাহ | ওয়া লা ইলাহা ইল্লাল্লাহ | ওয়াল্লাহু আকবার", tooltip: "প্রতিদিন ১০০ বার", loop: 100 },
          { id: "fOPmnFezp5w", start: 14.9, end: 16, label: "ইয়া জাল জালালি ওয়াল ইকরাম", tooltip: "প্রতিদিন ১০০ বার", loop: 100 },
          { id: "uv3VXLVK6FQ", start: 10, end: 30, label: "আল-ইখলাস", tooltip: "প্রতিদিন 14 বার", loop: 14 },
          { id: "Ar8COmg9hWE", start: 145.4, end: 147, label: "লা ইলাহা ইল্লাল্লাহ", tooltip: "প্রতিদিন ১০০ বার", loop: 100 },
          { id: "HcY-e7-lBBQ", start: 9.7, end: 29, label: "১০ লক্ষ নেকি পাওয়ার দোয়া", tooltip: "প্রতিদিন ১০ বার", loop: 11 },
        ]
      },
      {
        name: "AFTER NAMAJ",
        videos: [
          { id: "Xx85iIXcQNs", start: 5, end: 6, label: "আল্লাহু আকবার", tooltip: " ১ বার ", loop: 1 },
          { id: "Xx85iIXcQNs", start: 7.7, end: 9, label: "আস্তাগফিরুল্লাহ", tooltip: "আমি আল্লাহর ক্ষমাপ্রার্থনা করছি ।", loop: 3 },
          { id: "paplOoJGGxg", start: 1, end: 10, label: "সুবহানাল্লাহ | ওয়ালহামদুলিল্লাহ | ওয়া লা ইলাহা ইল্লাল্লাহ | ওয়াল্লাহু আকবার", tooltip: "প্রতিদিন ১০০ বার", loop: 33 },
          { id: "Xx85iIXcQNs", start: 19, end: 25.2, label: "ADD", tooltip: "আল্লাহুম্মা ইন্নাকা আফুউন কারীম, তুহিব্বুল আফুওয়া ফাফু আন্নি", loop: 1 },
        ]
      },
      {
        name: "ইস্তেগফার",
        videos: [
          { id: "3b2NujLLSpw", start: 6, end: 43, label: "সাইয়েদুল ইস্তেগফার", tooltip: "প্রতিদিন ১০০ বার তওবা করা।", loop: 10 },
          { id: "U_5o4JEINfQ", start: 11.8, end: 17, label: "দোয়া ইউনুস", tooltip: "প্রতিদিন ১০০ বার", loop: 100 },
          { id: "VNoq93-17Ho", start: 2, end: 22, label: "আস্তাগফিরুল্লাহ", tooltip: "আমি আল্লাহর ক্ষমাপ্রার্থনা করছি ।", loop: 10 },
          { id: "UFMf485VTiI", start: 45, end: 48.2, label: "লা হাওলা ওয়ালা কুওয়াতা ইল্লা বিল্লাহিল আলিউল আজিম", tooltip: "আল্লাহ ছাড়া কোনো ভরসা নেই, কোনো ক্ষমতা বা শক্তি নেই | প্রতিদিন ১০০ বার", loop: 100 },
          { id: "V4WF16FhLcg", start: 3.8, end: 6, label: "রাব্বির ফিরলি জুনুবি", tooltip: "রাব্বির ফিরলি জুনুবি প্রতিদিন 21 বার", loop: 21 },
          { id: "aPbwuL9-C7A", start: 0, end: 22, label: "ইস্তেগফার 03", tooltip: "আল্লাহুম্মা ইন্নাকা আফুউন কারীম, তুহিব্বুল আফুওয়া ফাফু আন্নি", loop: 7 }
        ]
      },
      {
        name: "রিজিক",
        videos: [
          { id: "SEh3c0Va5qk", start: 5, end: 8.5, label: "আল্লাহুম্মা ইন্নি আস আলুকা মিন ফাদলিক", tooltip: "আল্লাহুম্মা ইন্নি আস আলুকা মিন ফাদলিক", loop: 21 },
          { id: "d-AzKo4dOoc", start: 0, end: 11, label: "সূরা আল-বাকারা থেকে দুআ (2:201)", tooltip: "সূরা আল-বাকারা থেকে দুআ (2:201).", loop: 21 },
          { id: "r-pn59nB5RQ", start: 0, end: 7, label: "হযরত মুসার দুআ (কুরআন 28:24)", tooltip: "হযরত মুসার দুআ (কুরআন 28:24).", loop: 21 },
          { id: "H1UVp0XlhBs", start: 5.1, end: 11, label: "সম্পদ ও হেদায়েতের জন্য দুআ", tooltip: "সম্পদ ও হেদায়েতের জন্য দুআ", loop: 21 },
          { id: "K6BWL4gfCB8", start: 4.1, end: 9.8, label: "আল্লাহুম্মা ইন্নি আস'আলুকা", tooltip: "আল্লাহুম্মা ইন্নি আস'আলুকা ", loop: 21 },
          { id: "fX2SO9OpSXA", start: 14, end: 27.8, label: "ঋণ মুক্তির দোয়া - 01", tooltip: "ঋণ মুক্তির দোয়া ", loop: 21 },
          { id: "xGTdWJQhOhw", start: 151.4, end: 167, label: "ঋণ মুক্তির দোয়া - 02", tooltip: "ঋণ পরিশোধ হবে ইনশাআল্লাহ ", loop: 21 },
        ]
      },
      {
        name: "সব সমস্যা সমাধানে",
        videos: [
          { id: "maggkOnU6JY", start: 0, end: 9, label: "আলহামদু লিল্লা হিল্লাজি আফানি", tooltip: "আলহামদু লিল্লা হিল্লাজি আফানি ", loop: 3 },
          { id: "QA6jYhCXYyM", start: 0, end: 23, label: "ইসমে আজম", tooltip: "ইসমে আজম", loop: 21 },
          { id: "ueu7UtauHVc", start: 0, end: 66, label: "সূরা ফাতিহা", tooltip: "সূরা ফাতিহা", loop: 7 },
          { id: "zy3xIbbK6eE", start: 5, end: 130, label: "সূরা বাকারার শেষ দুই আয়াত", tooltip: "সূরা বাকারার শেষ দুই আয়াত", loop: 21 }
        ]
      },
      {
        name: "দোয়া কবুল হওয়ার আমল",
        videos: [
          { id: "14uh3215Vls", start: 0, end: 30, label: "দরুদ শরীফ", tooltip: "দরুদ শরীফ", loop: 100 },
          { id: "v45_ITHAgdY", start: 47.5, end: 51, label: "লা হাওলা ওয়ালা কুওয়াতা ইল্লা বিল্লাহিল ", tooltip: "আল্লাহ ছাড়া কোনো ভরসা নেই, কোনো ক্ষমতা বা শক্তি নেই | প্রতিদিন 499 বার", loop: 499 },
          { id: "UFMf485VTiI", start: 45, end: 48.2, label: "লা হাওলা ওয়ালা কুওয়াতা ইল্লা বিল্লাহিল আলিউল আজিম", tooltip: "আল্লাহ ছাড়া কোনো ভরসা নেই, কোনো ক্ষমতা বা শক্তি নেই | প্রতিদিন 1 বার", loop: 1 },
          { id: "14uh3215Vls", start: 0, end: 30, label: "দরুদ শরীফ", tooltip: "দরুদ শরীফ", loop: 100 },
        ]
      },
      {
        name: "OBAY",
        videos: [
          { id: "KCpucEqWHgI", start: 0, end: 18, label: "সূরা আল ফুরকান : ৭৪ আয়াত", tooltip: "সূরা আল ফুরকান : ৭৪ আয়াত.", loop: 21 },
          { id: "TAXr0OvvFd0", start: 14.5, end: 24, label: "সূরা ত্বা-হা : ৩৯ আয়াত", tooltip: "সূরা ত্বা-হা : ৩৯ আয়াত.", loop: 21 },
          { id: "vzNIHXjRgn4", start: 163, end: 165.1, label: "ইন্নাল্লাহা ইয়াস-মাউ মাই-ইয়াসা", tooltip: "ইন্নাল্লাহা ইয়াস-মাউ মাই-ইয়াসা", loop: 11 },
          { id: "Rs_g65sSGqk", start: 28, end: 29, label: "ইয়া ওয়াদুদু (313)", tooltip: "ইয়া ওয়াদুদু", loop: 313 },
          { id: "wMka1xyhV_w", start: 20.5, end: 21.4, label: "ইয়া লাতিফু (133)", tooltip: "ইয়া লাতিফু", loop: 133 },
          { id: "DNgrz8oYHcI", start: 6.5, end: 9, label: "হাসবুনাল্লাহু ওয়া নি’ মাল ওয়াকিল", tooltip: "হাসবুনাল্লাহু ওয়া নি’ মাল ওয়াকিল prayer.", loop: 100 }
        ]
      }
    ];

    // Dynamically generate dropdown options
    function generateDropdown() {
      const dropdown = document.getElementById('sectionDropdown');
      dropdown.innerHTML = '';
      videoSections.forEach((section, idx) => {
        const opt = document.createElement('option');
        opt.value = idx;
        opt.textContent = section.name;
        dropdown.appendChild(opt);
      });
    }

    // Generate section content
    function showSelectedSection() {
      const controlsDiv = document.getElementById('sectionControls');
      const sectionIdx = parseInt(document.getElementById('sectionDropdown').value, 10);
      const section = videoSections[sectionIdx];
      controlsDiv.innerHTML = '';

      const header = document.createElement('div');
      header.className = 'section-header';
      header.textContent = section.name;
      controlsDiv.appendChild(header);

      // Video list
      const ul = document.createElement('ul');
      ul.className = 'video-list';
      section.videos.forEach((video, vIdx) => {
        const li = document.createElement('li');
        li.innerHTML = `<span class="video-serial">${vIdx + 1}.</span>
                        <span class="video-label">${video.label}</span>
                        <span class="video-loop">x${video.loop}</span>`;
        ul.appendChild(li);
      });
      controlsDiv.appendChild(ul);

      // Play button
      const btn = document.createElement('button');
      btn.className = 'section-btn';
      btn.textContent = `Play : ${section.name}`;
      btn.onclick = () => playSection(sectionIdx);
      controlsDiv.appendChild(btn);
    }

    // YouTube Player logic
    let player;
    let playerReady = false;
    let currentLoopCount = 0;
    let currentMaxLoops = 1;
    let currentStartTime = 0;
    let currentEndTime = 0;
    let currentVideoId = '';
    let loopInterval = null;

    // Playlist control
    let currentSectionVideos = [];
    let playlistIndex = 0;

    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '100%',
        width: '100%',
        videoId: '',
        playerVars: {
          modestbranding: 1,
          rel: 0,
          autoplay: 0 // Don't autoplay until user clicks
        },
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    }

    function onPlayerReady() {
      playerReady = true;
    }

    function playSection(sectionIdx) {
      if (!playerReady) {
        alert("Player is not ready yet. Please wait a moment and try again.");
        return;
      }
      currentSectionVideos = videoSections[sectionIdx].videos;
      playlistIndex = 0;
      playNextInSection();
    }

    function playNextInSection() {
      if (playlistIndex >= currentSectionVideos.length) {
        // All videos finished, pause the player
        if (player && typeof player.pauseVideo === "function") {
          player.pauseVideo();
        }
        updateDisplay(0, 0);
        document.getElementById('tooltipText').textContent = '';
        return;
      }
      const item = currentSectionVideos[playlistIndex];
      currentVideoId = item.id;
      currentStartTime = item.start;
      currentEndTime = item.end;
      currentLoopCount = 0;
      currentMaxLoops = item.loop || 1;
      updateDisplay(0, currentMaxLoops);

      player.loadVideoById({
        videoId: currentVideoId,
        startSeconds: currentStartTime
      });

      // Show tooltip for current video
      document.getElementById('tooltipText').textContent = item.tooltip || '';
      // Try to play (required for some browsers)
      setTimeout(() => {
        if (typeof player.playVideo === "function") player.playVideo();
      }, 500);
    }

    function updateDisplay(played, remain) {
      document.getElementById("currentLoop").textContent = played;
      document.getElementById("remainingLoop").textContent = remain;
    }

    function onPlayerStateChange(event) {
      if (event.data === YT.PlayerState.PLAYING) {
        startLoopCheck();
      } else if (event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.ENDED) {
        clearLoopInterval();
      }
    }

    function startLoopCheck() {
      clearLoopInterval();

      loopInterval = setInterval(() => {
        if (!player || typeof player.getCurrentTime !== "function") return;
        const currentTime = player.getCurrentTime();
        let effectiveEndTime = currentEndTime || player.getDuration();

        if (currentTime >= effectiveEndTime) {
          currentLoopCount++;
          updateDisplay(currentLoopCount, currentMaxLoops - currentLoopCount);

          if (currentLoopCount < currentMaxLoops) {
            player.seekTo(currentStartTime);
            player.playVideo();
          } else {
            clearLoopInterval();
            playlistIndex++;
            if (playlistIndex < currentSectionVideos.length) {
              playNextInSection();
            } else {
              // Playlist finished, pause the player
              if (player && typeof player.pauseVideo === "function") {
                player.pauseVideo();
              }
              updateDisplay(0, 0);
              document.getElementById('tooltipText').textContent = '';
            }
          }
        }
      }, 200);
    }

    function clearLoopInterval() {
      if (loopInterval) {
        clearInterval(loopInterval);
        loopInterval = null;
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      generateDropdown();
      showSelectedSection();
      updateDisplay(0, 0);
    });
  </script>
</body>
</html>